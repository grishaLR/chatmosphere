/* Incoming call banner — fixed top-center notification */
.incomingBanner {
  position: fixed;
  top: var(--cm-space-4);
  left: 50%;
  transform: translateX(-50%);
  z-index: var(--cm-z-videocall);
  display: flex;
  align-items: center;
  gap: var(--cm-space-3);
  padding: var(--cm-space-3) var(--cm-space-4);
  background: var(--cm-titlebar);
  color: var(--cm-chrome-text);
  border-radius: var(--cm-radius-lg);
  box-shadow: var(--cm-raised), var(--cm-window-shadow);
  animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
}

.bannerIdentity {
  font-weight: 700;
  font-size: var(--cm-text-base);
}

.bannerLabel {
  font-size: var(--cm-text-sm);
}

.bannerActions {
  display: flex;
  gap: var(--cm-space-2);
}

.acceptBtn {
  width: var(--cm-call-btn-size);
  height: var(--cm-call-btn-size);
  border-radius: 50%;
  border: none;
  background: var(--color-success);
  color: var(--color-success-content);
  font-size: var(--cm-text-lg);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.acceptBtn:hover {
  opacity: 0.9;
}

.rejectBtn {
  width: var(--cm-call-btn-size);
  height: var(--cm-call-btn-size);
  border-radius: 50%;
  border: none;
  background: var(--color-error);
  color: var(--color-error-content);
  font-size: var(--cm-text-lg);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.rejectBtn:hover {
  opacity: 0.9;
}

/* Floating call container — draggable + resizable */
.container {
  position: fixed;
  bottom: var(--cm-space-4);
  right: var(--cm-space-4);
  width: var(--cm-panel-width-dm);
  z-index: var(--cm-z-videocall);
  border-radius: var(--cm-radius-lg);
  box-shadow: var(--cm-raised), var(--cm-window-shadow);
  overflow: visible;
  background: var(--cm-titlebar);
  display: flex;
  flex-direction: column;
}

.header {
  display: flex;
  align-items: center;
  gap: var(--cm-space-3);
  padding: 0 var(--cm-space-3);
  height: var(--cm-header-h);
  background: var(--cm-titlebar);
  color: var(--cm-chrome-text);
  flex-shrink: 0;
  border-radius: var(--cm-radius-lg) var(--cm-radius-lg) 0 0;
  user-select: none;
}

.headerIdentity {
  flex: 1;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: var(--cm-text-base);
  font-weight: 700;
}

.headerStatus {
  font-size: var(--cm-text-sm);
  opacity: 0.8;
}

.videosContainer {
  position: relative;
  flex: 1;
  min-height: 0;
  background: black;
  overflow: hidden;
  border-radius: 0 0 var(--cm-radius-lg) var(--cm-radius-lg);
}

.remoteVideo {
  width: 100%;
  height: 100%;
  min-height: var(--cm-call-video-min-h);
  display: block;
  background: black;
  object-fit: cover;
}

.localVideo {
  position: absolute;
  bottom: var(--cm-space-2);
  right: var(--cm-space-2);
  width: var(--cm-call-pip-w);
  aspect-ratio: 4 / 3;
  background: var(--cm-titlebar);
  border-radius: var(--cm-radius-sm);
  border: 1px solid var(--cm-surface);
  object-fit: cover;
  z-index: 1;
}

.headerHangUp {
  width: var(--cm-icon-lg);
  height: var(--cm-icon-lg);
  border-radius: 50%;
  border: none;
  background: var(--color-error);
  color: var(--color-error-content);
  font-size: var(--cm-text-base);
  line-height: 1;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.headerHangUp:hover {
  opacity: 0.85;
}

.ringing {
  padding: var(--cm-space-4);
  text-align: center;
  color: var(--cm-chrome-text);
  font-size: var(--cm-text-sm);
}

/* Resize handles — invisible hit areas around all edges and corners */
.resizeHandle {
  position: absolute;
  z-index: 3;
}

/* Edge handles */
.resizeN {
  top: calc(var(--cm-call-resize-edge) / -2);
  left: var(--cm-call-resize-corner);
  right: var(--cm-call-resize-corner);
  height: var(--cm-call-resize-edge);
  cursor: n-resize;
}

.resizeS {
  bottom: calc(var(--cm-call-resize-edge) / -2);
  left: var(--cm-call-resize-corner);
  right: var(--cm-call-resize-corner);
  height: var(--cm-call-resize-edge);
  cursor: s-resize;
}

.resizeE {
  top: var(--cm-call-resize-corner);
  bottom: var(--cm-call-resize-corner);
  right: calc(var(--cm-call-resize-edge) / -2);
  width: var(--cm-call-resize-edge);
  cursor: e-resize;
}

.resizeW {
  top: var(--cm-call-resize-corner);
  bottom: var(--cm-call-resize-corner);
  left: calc(var(--cm-call-resize-edge) / -2);
  width: var(--cm-call-resize-edge);
  cursor: w-resize;
}

/* Corner handles */
.resizeNE {
  top: calc(var(--cm-call-resize-edge) / -2);
  right: calc(var(--cm-call-resize-edge) / -2);
  width: var(--cm-call-resize-corner);
  height: var(--cm-call-resize-corner);
  cursor: ne-resize;
}

.resizeNW {
  top: calc(var(--cm-call-resize-edge) / -2);
  left: calc(var(--cm-call-resize-edge) / -2);
  width: var(--cm-call-resize-corner);
  height: var(--cm-call-resize-corner);
  cursor: nw-resize;
}

.resizeSE {
  bottom: calc(var(--cm-call-resize-edge) / -2);
  right: calc(var(--cm-call-resize-edge) / -2);
  width: var(--cm-call-resize-corner);
  height: var(--cm-call-resize-corner);
  cursor: se-resize;
}

.resizeSW {
  bottom: calc(var(--cm-call-resize-edge) / -2);
  left: calc(var(--cm-call-resize-edge) / -2);
  width: var(--cm-call-resize-corner);
  height: var(--cm-call-resize-corner);
  cursor: sw-resize;
}

/* Control bar — mute, flip camera */
.controlBar {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--cm-space-3);
  padding: var(--cm-space-2) 0;
  background: var(--cm-titlebar);
  border-top: 1px solid var(--cm-surface);
  flex-shrink: 0;
}

.controlBtn {
  width: var(--cm-icon-lg);
  height: var(--cm-icon-lg);
  border-radius: var(--cm-radius-sm);
  border: none;
  background: var(--cm-surface-button);
  color: var(--cm-chrome-text);
  font-size: var(--cm-text-base);
  line-height: 1;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.controlBtn:hover {
  opacity: 0.85;
}

.controlBtnActive {
  background: var(--color-error);
  color: var(--color-error-content);
}

.flipBtn {
  display: none;
}

/* Reconnecting overlay — semi-transparent over frozen video */
.reconnectingOverlay {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgb(0 0 0 / 0.5);
  color: var(--cm-chrome-text);
  font-size: var(--cm-text-base);
  font-weight: 700;
  z-index: 1;
  animation: pulse 1.5s ease-in-out infinite;
}

@keyframes pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.6;
  }
}

/* Error banner — temporary notification for call errors */
.errorBanner {
  position: fixed;
  top: var(--cm-space-4);
  left: 50%;
  transform: translateX(-50%);
  z-index: var(--cm-z-videocall);
  padding: var(--cm-space-3) var(--cm-space-4);
  background: var(--color-error);
  color: var(--color-error-content);
  border-radius: var(--cm-radius-lg);
  box-shadow: var(--cm-raised);
  font-size: var(--cm-text-sm);
  font-weight: 600;
  animation: slideDown 0.2s ease-out;
}

/* Touch devices — larger hit areas for fingers, show flip button */
@media (pointer: coarse) {
  :root {
    --cm-call-resize-edge: 12px;
    --cm-call-resize-corner: 20px;
  }

  .flipBtn {
    display: flex;
  }
}
